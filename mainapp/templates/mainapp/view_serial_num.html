{% load static %}
<!Doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <title>DBU</title>
    <link rel="stylesheet" type="text/css" href="{% static 'mainapp/css/style.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'mainapp/css/style_view.css' %}">
  </head>
  <body>
    <header>        
        <div class="container">
          {% if user.is_authenticated %}
            <a id="login_button"href="{% url 'login' %}">{{ user.get_username }}</a>
          {% else %}
            <a id="login_button"href="{% url 'login' %}">Войти</a>
          {% endif %}             
          <div id="pagename"><a href="{% url 'index' %}">DBU</a></div>        
        </div>      
    </header>  
    <main>
        <div class="container">
            
            <div class="menu">
                <a href="{% url 'index' %}" class="ref_button">Главная</a>
                <a href="{% url 'view' %}" class="ref_button" id="chosen_page">Просмотр</a>
                <a href="{% url 'login' %}" class="ref_button">Профиль</a>
            </div>
        
            <div class="mainpart">
                <div id="tabs"><a href="{% url 'view' %}">Список</a>><a href="{% url 'view_type' type %}">{{ type }}</a>><a href="{% url 'view_serial_num' type serial_num %}">{{ serial_num }}</a></div>              
                <form action={% url "proccess_type_form" %} method="POST" enctype="multipart/form-data">                
                    {% csrf_token %}               
                    <div id="view_type">
                        <div id="img_box">
                            <img id="type_foto" src='{{ type_sample.img_link }}' alt="Фото типа" />                          
                            {% if user.is_authenticated %}                                                    
                            <div>                                              
                              <input id="id_image" type="file" name="img_file" class="form-control" />                            
                            </div>
                            {% endif %}
                        </div>
                        <div>
                            <div>Тип</div>
                            <select name="type_" title='Тип' id="select_type">              
                                <option disabled>Выберите тип!</option>
                                {% for type_ in type_list %}                
                                  <option {% if type_.name == type_sample.name %}selected{% endif %}
                                  >{{ type_.name }}</option>                  
                                {% endfor %}
                              </select>
                            <div>Дополнительно</div>
                            <textarea class="textarea_standart_size1" name="additional_info"
                            {% if not user.is_authenticated %}
                            readonly
                            {% endif %}
                            >{{ type_sample.additional_info }}</textarea>
                            <div>
                                <label for="loc_of_soft">ПО хранится:<br></label>
                                <textarea class="textarea_standart_size3" id="loc_of_soft" name="loc_of_soft"
                                {% if not user.is_authenticated %}
                                readonly
                                {% endif %}
                                >{{ type_sample.soft_link }}</textarea>                                                        
                            </div>        
                              
                        </div> 
                        {% if user.is_authenticated %}
                        <input type="submit" id="submit_type_change" value="Сохранить изменения для типа">
                        {% endif %}
                    </div>
                </form>
                <form action={% url "proccess_profile_form" %} method="POST" enctype="multipart/form-data"> 
                    {% csrf_token %}   
                    <div class="rel_pos"><h2>Анкета</h2><input type="submit" class="submit_change" id="submit_profile_change" value="Сохранить изменения в Анкете"></div>
                    <div id="view_serial_num">
                        <div class="one_line_blocks">
                        <div>Серийный №</div>
                        <select name="serial_num" title='Серийный №' >              
                            <option disabled>Выберите серийный №!</option>
                            {% for one_entity in entity_list %}                
                                <option {% if one_entity == Entity %}selected{% endif %}
                                >{{ one_entity.serial_num }}</option>                  
                            {% endfor %}                           
                        </select>                      
                        </div>
                        <div class="one_line_blocks">
                            <div class="profile_property"><input type="checkbox" class="checkbox" id="special_check" name='special_check' {% if Entity.spec_check %}checked="checked"{% endif %}><label for="special_check"> Спецпроверка</label></div>                                                       
                        </div>
                        <div class="one_line_blocks">
                            <div class="profile_property"><input type="checkbox" class="checkbox" id="available" name="available" {% if Entity.status %}checked="checked"{% endif %}><label for="available"> Свободен</label></div>                             
                        </div>
                    </div>                
                    <div id="view_profile">
                        <div>                                                                        
                            <div class="profile_property">                                
                                </label>
                                    <input type="date" id="production_date" name="production_date" value={{ Entity.date_made }}> Дата изготовления
                                <label for="production_date"> 
                            </div>
                            <div class="profile_property">
                                <label for="label_ref">Этикетка: </label>
                                <a href="{{ Entity.label }}" download>{% if Entity.label %}Скачать{% endif %}</a>
                                <input type="file" id="label_ref" name="label_ref">
                            </div>                        
                            <div class="profile_property">
                                <label for="loc_of_storage_original_label">Место хранения оригинала этикетки: </label>
                                <input type="text" id="loc_of_storage_original_label" name="loc_of_storage_original_label" value={{ Entity.label_original }}>
                            </div>                        
                            <div class="profile_property"><label>
                                <input type="date" id="date_of_delivery" name="date_of_delivery" value={{ Entity.date_delivered }}>Дата поставки</label for="date_of_delivery">
                            </div>
                            <div class="profile_property">
                                <label for="delivery_document">Документ поставки: </label>
                                <a href="{{ Entity.doc_delivered }}" download>{% if Entity.doc_delivered %}Скачать{% endif %}</a>
                                <input type="file" id="delivery_document" name="delivery_document">
                            </div>
                            <div class="profile_property">
                                <label for="loc_of_storage_original_delivery_document">Место хранения оригинала документа поставки: </label>
                                <input type="text" id="loc_of_storage_original_delivery_document" name="loc_of_storage_original_delivery_document" value={{ Entity.doc_delivered_original }}>
                            </div>
                            <div class="profile_property">
                                <label for="note">Примечание: </label>
                                <textarea class="textarea_standart_size1" name="note" id="note"
                                    {% if not user.is_authenticated %}
                                    readonly
                                    {% endif %}
                                    >{{ Entity.note }}</textarea>
                            </div>
                        </div>
                    </div>
                </form>
                <div class="rel_pos"><h2>История</h2><input type="submit" class="submit_change" id="submit_history_change" value="Сохранить изменения в истории"></div>
                <div id="view_history">                 
                    <table>
                        <tr>           
                            <th title="Номер сеанса">Сеанс №</th>
                            <th colspan="2" title="Дата взятия и возвращения">Дата</th>
                            <th title="Место взятия">Куда</th>
                            <th title="Имя пользователь">Пользователь</th>                
                            <th colspan="2" title="Имя администратора выдачи и приема">Администратор</th>
                            <th title="Комментарий к сеансу">Комментарий</th>
                        </tr>
                        <tr>    
                            <td></td>
                            <td>Взятие</td>
                            <td>Сдача</td>
                            <td></td>
                            <td></td>
                            <td>Выдача</td>
                            <td>Прием</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td><input type="date" id="date_taken"></td>
                            <td><input type="date" id="date_return"></td>
                            <td>КПРМ-1203 6s-703</td>
                            <td>Сергей Алексеевич Ильичевский</td>
                            <td>Антон Артьемьев</td>
                            <td>Витас Кущински</td>
                            <td>Взято для тестов голосового управления Эмминой отверткой</td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td><input type="date" id="date_taken"></td>
                            <td><input type="date" id="date_return"></td>
                            <td>К1ыМ-121 вs-0ф3</td>
                            <td>Сергей Алексеевич Ильичевский</td>
                            <td>Антон Ын</td>
                            <td>Лукас Керноговски-Сибиряк</td>
                            <td>Мама сказала взять</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </main> 
    <script type="text/javascript" src="http://code.jquery.com/jquery-3.4.1.js"></script>   
    <script src="{% static 'mainapp/js/view_type/view_serial_num_manage.js' %}"></script>    
  </body>
</html>
  